<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Polish Master Trainer</title>
    <meta name="theme-color" content="#1a73e8">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/197/197529.png">

    <style>
        :root { --primary: #1a73e8; --secondary: #34a853; --bg: #f0f2f5; --card: #fff; --text: #202124; --border: #ddd; }
        .dark-mode { --primary: #8ab4f8; --secondary: #81c995; --bg: #121212; --card: #1e1e1e; --text: #e8eaed; --border: #3c4043; }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: -apple-system, system-ui, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 10px; min-height: 100vh; display: flex; flex-direction: column; align-items: center; }

        /* Header & Nav */
        .header { text-align: center; margin-bottom: 10px; width: 100%; max-width: 500px; display: flex; justify-content: space-between; align-items: center; }
        .title { font-weight: 800; font-size: 1.1rem; color: var(--primary); text-transform: uppercase; }
        .settings-btn { background: none; border: none; font-size: 1.4rem; cursor: pointer; padding: 5px; }

        .nav-scroller { display: flex; gap: 8px; overflow-x: auto; padding: 5px; background: var(--card); border-radius: 25px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); margin-bottom: 15px; max-width: 500px; width: 100%; scrollbar-width: none; }
        .nav-btn { background: none; border: none; padding: 8px 16px; border-radius: 20px; font-weight: 600; font-size: 0.9rem; color: #5f6368; white-space: nowrap; cursor: pointer; transition: all 0.2s; }
        .nav-btn.active { background: var(--primary); color: #fff; }

        /* Main Card */
        .card { background: var(--card); padding: 20px; border-radius: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); width: 100%; max-width: 500px; display: flex; flex-direction: column; gap: 15px; border: 1px solid var(--border); }

        /* Sliders & Controls */
        .control-group { background: rgba(0,0,0,0.03); padding: 10px; border-radius: 10px; border: 1px solid var(--border); }
        .slider-row { display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; font-size: 0.85rem; font-weight: 600; }
        input[type=range] { width: 100%; cursor: pointer; }
        
        .toggle-row { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; }
        .toggle-label { font-size: 0.9rem; display: flex; align-items: center; gap: 5px; cursor: pointer; }

        /* Display Area */
        .display-area { text-align: center; padding: 20px 0; border-top: 1px solid var(--border); border-bottom: 1px solid var(--border); margin: 5px 0; }
        .pl-text { font-size: 1.6rem; color: var(--primary); font-weight: 700; margin-bottom: 8px; line-height: 1.3; min-height: 1.3em; visibility: hidden; }
        .en-text { font-size: 1.1rem; color: #888; font-weight: 500; min-height: 1.3em; visibility: hidden; }
        .visible { visibility: visible !important; animation: fadeIn 0.3s; }

        /* Buttons */
        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .btn { padding: 12px; border: none; border-radius: 10px; font-weight: 700; font-size: 0.95rem; color: white; cursor: pointer; display: flex; justify-content: center; align-items: center; transition: transform 0.1s; }
        .btn:active { transform: scale(0.98); }
        .btn-audio { background: var(--secondary); grid-column: span 2; }
        .btn-reveal { background: var(--primary); }
        .btn-next { background: #455a64; grid-column: span 2; font-size: 1.1rem; padding: 14px; margin-top: 5px; }
        .btn-small { background: #fb8c00; font-size: 0.8rem; padding: 8px; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* Drawer */
        .drawer { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center; }
        .drawer-content { background: var(--card); padding: 25px; border-radius: 15px; width: 90%; max-width: 350px; }
    </style>
</head>
<body onload="init()">

<div class="header">
    <div class="title">Polish Trainer</div>
    <button class="settings-btn" onclick="toggleDrawer()">‚öôÔ∏è</button>
</div>

<div class="nav-scroller">
    <button class="nav-btn active" onclick="setMode('numbers')" id="nav-numbers">Numbers</button>
    <button class="nav-btn" onclick="setMode('prices')" id="nav-prices">Prices</button>
    <button class="nav-btn" onclick="setMode('dates')" id="nav-dates">Dates</button>
    <button class="nav-btn" onclick="setMode('time')" id="nav-time">Time</button>
    <button class="nav-btn" onclick="setMode('weights')" id="nav-weights">Weights</button>
</div>

<div class="card">
    
    <div id="controls-numbers" class="control-group">
        <div class="slider-row">
            <span>Min: <span id="lbl-min">1</span></span>
            <input type="range" id="minP" min="0" max="6" value="0" oninput="updateUI()">
        </div>
        <div class="slider-row">
            <span>Max: <span id="lbl-max">10</span></span>
            <input type="range" id="maxP" min="1" max="7" value="1" oninput="updateUI()">
        </div>
        <div class="toggle-row" style="margin-top:10px;">
            <label class="toggle-label"><input type="checkbox" id="neg-toggle" onchange="generate()"> Negatives</label>
        </div>
    </div>

    <div id="controls-prices" class="control-group" style="display:none">
        <div class="toggle-row">
            <label class="toggle-label"><input type="checkbox" id="grosze-toggle" checked onchange="generate()"> Include Grosze</label>
        </div>
    </div>

    <div id="controls-time" class="control-group" style="display:none">
        <div class="toggle-row">
            <label class="toggle-label"><input type="radio" name="t-style" value="formal" onchange="generate()"> Formal</label>
            <label class="toggle-label"><input type="radio" name="t-style" value="casual" checked onchange="generate()"> Casual</label>
        </div>
    </div>

    <div id="controls-dates" class="control-group" style="display:none">
        <div class="toggle-row">
            <label class="toggle-label"><input type="checkbox" id="year-toggle" checked onchange="generate()"> Include Year</label>
        </div>
    </div>

    <div class="display-area">
        <div id="pl-text" class="pl-text">---</div>
        <div id="en-text" class="en-text">---</div>
    </div>

    <div class="btn-grid">
        <button class="btn btn-audio" onclick="speak(1.0)">üîä Repeat Audio</button>
        <button class="btn btn-small" onclick="speak(0.5)">üê¢ Slow</button>
        <button class="btn btn-small" onclick="speak(0.2)">üêå Snail</button>
        
        <button class="btn btn-reveal" onclick="reveal('pl-text')">üëÅÔ∏è Polish</button>
        <button class="btn btn-reveal" style="background:#673ab7" onclick="reveal('en-text')">üëÅÔ∏è Meaning</button>
        
        <button class="btn btn-next" onclick="generate()">NEXT ‚û°Ô∏è</button>
    </div>
</div>

<div id="drawer" class="drawer">
    <div class="drawer-content">
        <h3>Settings</h3>
        <label class="toggle-label" style="margin-bottom:15px">
            <input type="checkbox" onchange="document.body.classList.toggle('dark-mode')"> Dark Mode
        </label>
        <button class="btn btn-next" onclick="toggleDrawer()">Close</button>
    </div>
</div>

<script>
    // --- LINGUISTIC DATA ---
    const UNITS = ["", "jeden", "dwa", "trzy", "cztery", "piƒôƒá", "sze≈õƒá", "siedem", "osiem", "dziewiƒôƒá"];
    const TEENS = ["dziesiƒôƒá", "jedena≈õcie", "dwana≈õcie", "trzyna≈õcie", "czterna≈õcie", "piƒôtna≈õcie", "szesna≈õcie", "siedemna≈õcie", "osiemna≈õcie", "dziewiƒôtna≈õcie"];
    const TENS = ["", "", "dwadzie≈õcia", "trzydzie≈õci", "czterdzie≈õci", "piƒôƒádziesiƒÖt", "sze≈õƒádziesiƒÖt", "siedemdziesiƒÖt", "osiemdziesiƒÖt", "dziewiƒôƒádziesiƒÖt"];
    const HUNDREDS = ["", "sto", "dwie≈õcie", "trzysta", "czterysta", "piƒôƒáset", "sze≈õƒáset", "siedemset", "osiemset", "dziewiƒôtset"];
    const MONTHS_PL = ["stycznia", "lutego", "marca", "kwietnia", "maja", "czerwca", "lipca", "sierpnia", "wrze≈õnia", "pa≈∫dziernika", "listopada", "grudnia"];
    const MONTHS_EN = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
    
    // Time specific arrays
    const HOURS_ORD_FEM = ["p√≥≈Çnoc", "pierwsza", "druga", "trzecia", "czwarta", "piƒÖta", "sz√≥sta", "si√≥dma", "√≥sma", "dziewiƒÖta", "dziesiƒÖta", "jedenasta", "dwunasta", "trzynasta", "czternasta", "piƒôtnasta", "szesnasta", "siedemnasta", "osiemnasta", "dziewiƒôtnasta", "dwudziesta", "dwudziesta pierwsza", "dwudziesta druga", "dwudziesta trzecia"];
    const HOURS_ORD_GEN = ["p√≥≈Çnocy", "pierwszej", "drugiej", "trzeciej", "czwartej", "piƒÖtej", "sz√≥stej", "si√≥dmej", "√≥smej", "dziewiƒÖtej", "dziesiƒÖtej", "jedenastej", "dwunastej", "pierwszej"];

    let state = { mode: 'numbers', currentPL: '', currentEN: '' };

    function init() {
        updateUI();
        setMode('numbers');
    }

    // --- LOGIC: Number to Words ---
    function getPlural(n, s, pa, pb) {
        n = Math.abs(n);
        if (n === 1) return s;
        let r10 = n % 10, r100 = n % 100;
        if (r10 >= 2 && r10 <= 4 && (r100 < 10 || r100 > 20)) return pa;
        return pb;
    }

    function numToPl(n) {
        if (n === 0) return "zero";
        if (n < 0) return "minus " + numToPl(Math.abs(n));
        let s = "";
        if (n >= 1000000) { let m = Math.floor(n/1000000); s += (m===1?"":numToPl(m)+" ") + getPlural(m,"milion","miliony","milion√≥w") + " "; n %= 1000000; }
        if (n >= 1000) { let t = Math.floor(n/1000); s += (t===1?"tysiƒÖc":numToPl(t)+" "+getPlural(t,"tysiƒÖc","tysiƒÖce","tysiƒôcy")) + " "; n %= 1000; }
        if (n >= 100) { s += HUNDREDS[Math.floor(n/100)] + " "; n %= 100; }
        if (n >= 20) { s += TENS[Math.floor(n/10)] + " "; n %= 10; }
        if (n >= 10) { s += TEENS[n-10] + " "; n = 0; }
        if (n > 0) s += UNITS[n];
        return s.trim();
    }

    // --- LOGIC: Time to Words (The Fix) ---
    function timeToPl(h, m, formal) {
        if (formal) {
            // Formal: "Hour" + "Minute" (e.g. "trzynasta piƒôtna≈õcie")
            let hStr = (h===0) ? "zero zero" : HOURS_ORD_FEM[h];
            let mStr = (m===0) ? "" : (m<10 ? "zero "+UNITS[m] : numToPl(m));
            return `${hStr} ${mStr}`.trim();
        } else {
            // Casual: "wp√≥≈Ç do", "po", "za"
            let dispH = h % 12;
            let hNow = HOURS_ORD_FEM[(dispH===0?12:dispH)];
            let hNext = HOURS_ORD_GEN[(dispH===0?0:dispH) + 1]; 
            // Handle index overflow for 12 -> 1
            if((dispH===0?0:dispH) + 1 >= HOURS_ORD_GEN.length) hNext = HOURS_ORD_GEN[1];

            if (m === 0) return hNow;
            if (m === 30) return `wp√≥≈Ç do ${hNext}`;
            if (m < 30) return `${numToPl(m)} po ${HOURS_ORD_GEN[dispH===0?12:dispH]}`;
            return `za ${numToPl(60-m)} ${hNext}`;
        }
    }

    // --- GENERATOR ---
    function generate() {
        document.getElementById('pl-text').style.visibility = 'hidden';
        document.getElementById('en-text').style.visibility = 'hidden';

        const min = Math.pow(10, document.getElementById('minP').value);
        const max = Math.pow(10, document.getElementById('maxP').value);

        if (state.mode === 'numbers') {
            let n = Math.floor(Math.random() * (max - min + 1)) + min;
            if (document.getElementById('neg-toggle').checked && Math.random() > 0.5) n *= -1;
            state.currentEN = n.toLocaleString();
            state.currentPL = numToPl(n);
        } else if (state.mode === 'prices') {
            let n = Math.floor(Math.random() * (max - min + 1)) + min;
            let gr = document.getElementById('grosze-toggle').checked ? Math.floor(Math.random()*99)+1 : 0;
            state.currentEN = `${n},${gr.toString().padStart(2,'0')} z≈Ç`;
            state.currentPL = `${numToPl(n)} ${getPlural(n,'z≈Çoty','z≈Çote','z≈Çotych')}` + (gr>0 ? ` i ${numToPl(gr)} ${getPlural(gr,'grosz','grosze','groszy')}` : "");
        } else if (state.mode === 'time') {
            let h = Math.floor(Math.random() * 24);
            let m = Math.floor(Math.random() * 12) * 5;
            let isCasual = document.querySelector('input[name="t-style"]:checked').value === 'casual';
            
            state.currentEN = `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}`;
            state.currentPL = timeToPl(h, m, !isCasual);
        } else if (state.mode === 'dates') {
            let d = Math.floor(Math.random() * 30) + 1;
            let mIdx = Math.floor(Math.random() * 12);
            let y = document.getElementById('year-toggle').checked ? Math.floor(Math.random()*125)+1900 : 0;
            
            state.currentEN = `${d} ${MONTHS_EN[mIdx]}` + (y?` ${y}`:"");
            // Note: Simple ordinal logic used here for days
            let ord = ["", "pierwszy", "drugi", "trzeci", "czwarty", "piƒÖty", "sz√≥sty", "si√≥dmy", "√≥smy", "dziewiƒÖty", "dziesiƒÖty", "jedenasty", "dwunasty", "trzynasty", "czternasty", "piƒôtnasty", "szesnasty", "siedemnasty", "osiemnasty", "dziewiƒôtnasty", "dwudziesty", "dwudziesty pierwszy", "dwudziesty drugi", "dwudziesty trzeci", "dwudziesty czwarty", "dwudziesty piƒÖty", "dwudziesty sz√≥sty", "dwudziesty si√≥dmy", "dwudziesty √≥smy", "dwudziesty dziewiƒÖty", "trzydziesty", "trzydziesty pierwszy"];
            state.currentPL = `${ord[d]} ${MONTHS_PL[mIdx]}` + (y?` ${numToPl(y)} roku`:"");
        } else if (state.mode === 'weights') {
            let n = Math.floor(Math.random() * (max - min + 1)) + min;
            state.currentEN = n + " kg";
            state.currentPL = numToPl(n) + " " + getPlural(n, "kilogram", "kilogramy", "kilogram√≥w");
        }

        document.getElementById('pl-text').innerText = state.currentPL;
        document.getElementById('en-text').innerText = state.currentEN;
        setTimeout(() => speak(1.0), 100);
    }

    function reveal(id) {
        document.getElementById(id).style.visibility = 'visible';
        document.getElementById(id).classList.add('visible');
    }

    function updateUI() {
        let min = document.getElementById('minP').value;
        let max = document.getElementById('maxP').value;
        if(parseInt(max) <= parseInt(min)) { max = parseInt(min)+1; document.getElementById('maxP').value = max; }
        document.getElementById('lbl-min').innerText = Math.pow(10, min).toLocaleString();
        document.getElementById('lbl-max').innerText = Math.pow(10, max).toLocaleString();
    }

    function setMode(m) {
        state.mode = m;
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('nav-'+m).classList.add('active');
        
        ['numbers','prices','time','dates'].forEach(id => {
            let el = document.getElementById('controls-'+id);
            if(el) el.style.display = (id === m) ? 'block' : 'none';
        });
        // Default weights uses numbers sliders
        if(m === 'weights') document.getElementById('controls-numbers').style.display = 'block';

        generate();
    }

    function speak(rate) {
        window.speechSynthesis.cancel();
        let u = new SpeechSynthesisUtterance(state.currentPL);
        u.lang = 'pl-PL'; u.rate = rate;
        window.speechSynthesis.speak(u);
    }

    function toggleDrawer() {
        let d = document.getElementById('drawer');
        d.style.display = (d.style.display === 'flex') ? 'none' : 'flex';
    }
</script>
</body>
</html>
